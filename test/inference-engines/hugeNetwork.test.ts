import * as expect from 'expect'

import { IInferenceEngine } from '../../src/types'

import { network } from '../../models/huge-network'
import { InferenceEngine } from '../../src/index'

const infersGiveNoEvidence = (engine: IInferenceEngine) => {
  const { infer } = engine

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('0.0100')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.9703')
}

const infersGiveNode1True = (engine: IInferenceEngine) => {
  const { infer } = engine
  engine.setEvidence({ node1: ['T'] })

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.9999')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.0001')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('0.0100')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.9800')
}

const infersGiveNode1False = (engine: IInferenceEngine) => {
  const { infer } = engine
  engine.setEvidence({ node1: ['F'] })

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.5000')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('0.0100')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.4901')
}

const infersGiveNode39True = (engine: IInferenceEngine) => {
  const { infer } = engine
  engine.setEvidence({ node39: ['T'] })

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('0.0000')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.9703')
}

const infersGiveNode39False = (engine: IInferenceEngine) => {
  const { infer } = engine
  engine.setEvidence({ node39: ['F'] })

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.9801')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0199')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('1.0000')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.9703')
}

const infersGiveNode36True = (engine: IInferenceEngine) => {
  const { infer } = engine
  engine.setEvidence({ node36: ['T'] })

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('0.0000')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.0000')
}

const infersGiveNode36False = (engine: IInferenceEngine) => {
  const { infer } = engine
  engine.setEvidence({ node36: ['F'] })

  expect(infer({ node1: ['T'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node1: ['F'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node2: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node2: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node3: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node3: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node4: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node4: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node5: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node5: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node6: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node6: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node7: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node7: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node8: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node8: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node9: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node9: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node10: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node10: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node11: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node11: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node12: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node12: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node13: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node13: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node14: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node14: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node15: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node15: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node16: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node16: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node17: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node17: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node18: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node18: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node19: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node19: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node20: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node20: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node21: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node21: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node22: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node22: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node23: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node23: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node24: ['T'] }).toFixed(4)).toBe('0.0198')
  expect(infer({ node24: ['F'] }).toFixed(4)).toBe('0.9802')
  expect(infer({ node25: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node25: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node26: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node26: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node27: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node27: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node28: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node28: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node29: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node29: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node30: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node30: ['F'] }).toFixed(4)).toBe('0.0100')
  expect(infer({ node31: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node31: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node32: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node32: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node33: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node33: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node34: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node34: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node35: ['T'] }).toFixed(4)).toBe('0.9803')
  expect(infer({ node35: ['F'] }).toFixed(4)).toBe('0.0197')
  expect(infer({ node36: ['T'] }).toFixed(4)).toBe('0.0000')
  expect(infer({ node36: ['F'] }).toFixed(4)).toBe('1.0000')
  expect(infer({ node37: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node37: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node38: ['T'] }).toFixed(4)).toBe('0.9899')
  expect(infer({ node38: ['F'] }).toFixed(4)).toBe('0.0101')
  expect(infer({ node39: ['T'] }).toFixed(4)).toBe('0.9900')
  expect(infer({ node39: ['F'] }).toFixed(4)).toBe('0.0100')
  // Test of joint probability of nodes in the same clique
  expect(infer({ node26: ['T'], node27: ['T'], node25: ['T'] }).toFixed(4)).toBe('0.9703')
}

const tests: { [key: string]: (engine: IInferenceEngine) => void } = {
  'infers give no evidence': infersGiveNoEvidence,
  'infers give Node1 True': infersGiveNode1True,
  'infers give Node1 False': infersGiveNode1False,
  'infers give Node36 True': infersGiveNode36True,
  'infers give Node36 False': infersGiveNode36False,
  'infers give Node39 True': infersGiveNode39True,
  'infers give Node39 False': infersGiveNode39False,
}

describe('infers', () => {
  describe('hugeNetwork', () => {
    const testNames = Object.keys(tests)

    const engine = new InferenceEngine(network)
    for (const testName of testNames) {
      const createMethod = tests[testName]
      it(`${testName} with Junction Tree`, () => createMethod(engine))
    }
  })
})
